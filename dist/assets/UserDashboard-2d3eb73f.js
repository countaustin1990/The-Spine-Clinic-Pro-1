import{r as m,u as C,j as e,e as P,m as d,C as h,X as g}from"./index-c0a0ba9d.js";import{g as E,u as D,d as R,a as B}from"./userService-72adb267.js";import{C as u}from"./calendar-ab4377bd.js";import{F as f}from"./file-text-ccd56ab8.js";import{A as b}from"./alert-circle-df5a08fc.js";import{C as w}from"./check-circle-16947b56.js";const L=t=>{const[c,n]=m.useState({appointments:[],loading:!0,error:null}),o=async()=>{if(!t){n({appointments:[],loading:!1,error:null});return}try{n(r=>({...r,loading:!0,error:null}));const a=await E(t);n({appointments:a,loading:!1,error:null})}catch(a){n({appointments:[],loading:!1,error:"Failed to fetch appointments"}),console.error("Error fetching appointments:",a)}};return m.useEffect(()=>{o()},[t]),{...c,refreshAppointments:o,cancelAppointment:async a=>{try{return await D(a,{status:"cancelled"}),n(r=>({...r,appointments:r.appointments.map(l=>l.id===a?{...l,status:"cancelled"}:l)})),!0}catch(r){return console.error("Error cancelling appointment:",r),!1}},removeAppointment:async a=>{try{return await R(a),n(r=>({...r,appointments:r.appointments.filter(l=>l.id!==a)})),!0}catch(r){return console.error("Error removing appointment:",r),!1}}}},U=()=>{const{currentUser:t}=C(),{appointments:c,loading:n,error:o,cancelAppointment:y,refreshAppointments:N}=L(t==null?void 0:t.uid),[a,r]=m.useState(null),[l,j]=m.useState(!0);m.useEffect(()=>{window.scrollTo(0,0),(async()=>{if(t!=null&&t.uid)try{const i=await B(t.uid);r(i)}catch(i){console.error("Error fetching user profile:",i)}finally{j(!1)}else j(!1)})()},[t]);const v=async s=>{window.confirm("Are you sure you want to cancel this appointment?")&&await y(s)&&N()};if(n||l)return e.jsx(P,{});const x=c.filter(s=>s.status!=="cancelled"&&s.status!=="completed").sort((s,i)=>{const A=new Date(`${s.date} ${s.time}`),k=new Date(`${i.date} ${i.time}`);return A.getTime()-k.getTime()}),p=x.length>0?x[0]:null;return e.jsxs("div",{className:"pt-24 pb-16",children:[e.jsx("div",{className:"bg-sky-700 text-white py-8",children:e.jsxs("div",{className:"container-custom",children:[e.jsx("h1",{className:"text-3xl font-bold mb-2",children:"Patient Dashboard"}),e.jsxs("p",{className:"text-sky-100",children:["Welcome back, ",(a==null?void 0:a.displayName)||(t==null?void 0:t.displayName)||"Patient"]})]})}),e.jsx("div",{className:"container-custom py-8",children:e.jsxs("div",{className:"grid grid-cols-1 md:grid-cols-3 gap-6",children:[e.jsx("div",{className:"md:col-span-1",children:e.jsxs(d.div,{className:"bg-white rounded-lg shadow-md p-6 h-full",initial:{opacity:0,x:-20},animate:{opacity:1,x:0},transition:{duration:.5},children:[e.jsxs("div",{className:"flex items-center space-x-4 mb-6",children:[e.jsx("div",{className:"bg-sky-100 p-3 rounded-full",children:e.jsx(u,{className:"h-6 w-6 text-sky-600"})}),e.jsxs("div",{children:[e.jsx("h3",{className:"font-semibold",children:"Next Appointment"}),p?e.jsxs("p",{className:"text-sm text-gray-600",children:[p.date," at ",p.time]}):e.jsx("p",{className:"text-sm text-gray-600",children:"No upcoming appointments"})]})]}),e.jsx("hr",{className:"my-4"}),e.jsx("h3",{className:"font-semibold mb-3",children:"Quick Actions"}),e.jsxs("div",{className:"space-y-2",children:[e.jsxs("a",{href:"/book-appointment",className:"flex items-center p-2 hover:bg-gray-50 rounded-md text-gray-700",children:[e.jsx(u,{className:"h-5 w-5 mr-3 text-sky-600"}),"Book New Appointment"]}),e.jsxs("a",{href:"#medical-records",className:"flex items-center p-2 hover:bg-gray-50 rounded-md text-gray-700",children:[e.jsx(f,{className:"h-5 w-5 mr-3 text-sky-600"}),"View Medical Records"]})]})]})}),e.jsxs("div",{className:"md:col-span-2 space-y-6",children:[e.jsxs(d.div,{className:"bg-white rounded-lg shadow-md p-6",initial:{opacity:0,y:20},animate:{opacity:1,y:0},transition:{duration:.5},children:[e.jsxs("div",{className:"flex justify-between items-center mb-6",children:[e.jsx("h2",{className:"text-xl font-bold",children:"Upcoming Appointments"}),e.jsx("a",{href:"/book-appointment",className:"text-sm font-medium text-sky-600 hover:text-sky-700",children:"+ New Appointment"})]}),o&&e.jsx("div",{className:"bg-red-50 border-l-4 border-red-500 p-4 rounded mb-4",children:e.jsxs("div",{className:"flex",children:[e.jsx(b,{className:"h-5 w-5 text-red-500 mr-2"}),e.jsx("span",{className:"text-red-700",children:o})]})}),x.length>0?e.jsx("div",{className:"space-y-4",children:x.map(s=>e.jsx("div",{className:"border border-gray-100 rounded-lg p-4 hover:shadow-md transition-shadow",children:e.jsxs("div",{className:"flex flex-col sm:flex-row justify-between",children:[e.jsxs("div",{children:[e.jsxs("div",{className:"flex items-center mb-2",children:[e.jsx(h,{className:"h-4 w-4 text-gray-500 mr-2"}),e.jsxs("span",{className:"text-sm text-gray-600",children:[s.date," at ",s.time]})]}),e.jsx("h3",{className:"font-semibold",children:s.service}),e.jsx("p",{className:"text-sm text-gray-600",children:s.doctorName})]}),e.jsxs("div",{className:"mt-3 sm:mt-0 flex items-center",children:[s.status==="confirmed"?e.jsxs("span",{className:"bg-green-100 text-green-800 text-xs px-2 py-1 rounded-full flex items-center",children:[e.jsx(w,{className:"h-3 w-3 mr-1"}),"Confirmed"]}):e.jsxs("span",{className:"bg-amber-100 text-amber-800 text-xs px-2 py-1 rounded-full flex items-center",children:[e.jsx(h,{className:"h-3 w-3 mr-1"}),"Pending"]}),e.jsx("button",{onClick:()=>v(s.id),className:"ml-4 text-red-500 hover:text-red-700","aria-label":"Cancel appointment",children:e.jsx(g,{className:"h-5 w-5"})})]})]})},s.id))}):e.jsxs("div",{className:"text-center py-8",children:[e.jsx(u,{className:"h-12 w-12 mx-auto text-gray-400 mb-3"}),e.jsx("h3",{className:"text-lg font-medium text-gray-700 mb-1",children:"No Appointments"}),e.jsx("p",{className:"text-gray-500 mb-4",children:"You don't have any upcoming appointments."}),e.jsx("a",{href:"/book-appointment",className:"btn btn-primary py-2",children:"Book an Appointment"})]})]}),e.jsxs(d.div,{className:"bg-white rounded-lg shadow-md p-6",initial:{opacity:0,y:20},animate:{opacity:1,y:0},transition:{duration:.5,delay:.2},children:[e.jsx("h2",{className:"text-xl font-bold mb-6",children:"Past Appointments"}),c.filter(s=>s.status==="completed"||s.status==="cancelled").length>0?e.jsx("div",{className:"space-y-4",children:c.filter(s=>s.status==="completed"||s.status==="cancelled").map(s=>e.jsx("div",{className:"border border-gray-100 rounded-lg p-4 hover:shadow-md transition-shadow",children:e.jsxs("div",{className:"flex flex-col sm:flex-row justify-between",children:[e.jsxs("div",{children:[e.jsxs("div",{className:"flex items-center mb-2",children:[e.jsx(h,{className:"h-4 w-4 text-gray-500 mr-2"}),e.jsxs("span",{className:"text-sm text-gray-600",children:[s.date," at ",s.time]})]}),e.jsx("h3",{className:"font-semibold",children:s.service}),e.jsx("p",{className:"text-sm text-gray-600",children:s.doctorName})]}),e.jsx("div",{className:"mt-3 sm:mt-0 flex items-center",children:s.status==="completed"?e.jsxs("span",{className:"bg-blue-100 text-blue-800 text-xs px-2 py-1 rounded-full flex items-center",children:[e.jsx(w,{className:"h-3 w-3 mr-1"}),"Completed"]}):e.jsxs("span",{className:"bg-red-100 text-red-800 text-xs px-2 py-1 rounded-full flex items-center",children:[e.jsx(g,{className:"h-3 w-3 mr-1"}),"Cancelled"]})})]})},s.id))}):e.jsxs("div",{className:"text-center py-8",children:[e.jsx(f,{className:"h-12 w-12 mx-auto text-gray-400 mb-3"}),e.jsx("h3",{className:"text-lg font-medium text-gray-700 mb-1",children:"No Past Appointments"}),e.jsx("p",{className:"text-gray-500",children:"Your past appointment history will appear here."})]})]}),e.jsxs(d.div,{id:"medical-records",className:"bg-white rounded-lg shadow-md p-6",initial:{opacity:0,y:20},animate:{opacity:1,y:0},transition:{duration:.5,delay:.3},children:[e.jsx("h2",{className:"text-xl font-bold mb-6",children:"Medical Records"}),e.jsxs("div",{className:"text-center py-8",children:[e.jsx(f,{className:"h-12 w-12 mx-auto text-gray-400 mb-3"}),e.jsx("h3",{className:"text-lg font-medium text-gray-700 mb-1",children:"No Records Yet"}),e.jsx("p",{className:"text-gray-500 mb-4",children:"Your medical records will appear here after your first appointment."})]})]}),e.jsx(d.div,{className:"bg-sky-50 border-l-4 border-sky-500 p-4 rounded-r-lg",initial:{opacity:0,y:20},animate:{opacity:1,y:0},transition:{duration:.5,delay:.4},children:e.jsxs("div",{className:"flex",children:[e.jsx(b,{className:"h-6 w-6 text-sky-600 mr-3 flex-shrink-0"}),e.jsxs("div",{children:[e.jsx("h3",{className:"font-semibold text-sky-800 mb-1",children:"Appointment Reminder"}),e.jsx("p",{className:"text-sm text-sky-700",children:"Please arrive 15 minutes before your scheduled appointment time. Don't forget to bring your insurance card and any relevant medical records."})]})]})})]})]})})]})};export{U as default};
