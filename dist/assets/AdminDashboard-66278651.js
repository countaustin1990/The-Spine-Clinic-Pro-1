import{c as f,r as n,u as L,j as e,e as U,m as o,X as B}from"./index-c0a0ba9d.js";import{b as $,c as H,u as I,d as V}from"./userService-72adb267.js";import{A as k}from"./alert-circle-df5a08fc.js";import{C}from"./calendar-ab4377bd.js";import{U as q}from"./users-7be3d56c.js";import{F as z}from"./file-text-ccd56ab8.js";import{C as M}from"./check-circle-16947b56.js";const O=f("BarChart2",[["line",{x1:"18",x2:"18",y1:"20",y2:"10",key:"1xfpm4"}],["line",{x1:"12",x2:"12",y1:"20",y2:"4",key:"be30l9"}],["line",{x1:"6",x2:"6",y1:"20",y2:"14",key:"1r4le6"}]]),W=f("Edit",[["path",{d:"M11 4H4a2 2 0 0 0-2 2v14a2 2 0 0 0 2 2h14a2 2 0 0 0 2-2v-7",key:"1qinfi"}],["path",{d:"M18.5 2.5a2.121 2.121 0 0 1 3 3L12 15l-4 1 1-4 9.5-9.5z",key:"1cs3r3"}]]),X=f("Trash",[["path",{d:"M3 6h18",key:"d0wm0j"}],["path",{d:"M19 6v14c0 1-1 2-2 2H7c-1 0-2-1-2-2V6",key:"4alrt4"}],["path",{d:"M8 6V4c0-1 1-2 2-2h4c1 0 2 1 2 2v2",key:"v07s0e"}]]),te=()=>{const[p,h]=n.useState([]),[b,y]=n.useState([]),[T,u]=n.useState(!0),[d,D]=n.useState("today"),[w,m]=n.useState(""),[x,E]=n.useState({totalAppointments:0,appointmentsThisMonth:0,newPatientsThisMonth:0,appointmentCompletionRate:0}),{currentUser:g,userRole:j}=L();n.useEffect(()=>{(async()=>{if(j!=="admin"){u(!1);return}try{u(!0),m("");const s=await $();h(s);const a=await H(),i=new Date,v=i.getMonth(),A=i.getFullYear(),F=s.filter(l=>{const c=new Date(l.date);return c.getMonth()===v&&c.getFullYear()===A}).length,R=s.filter(l=>l.status==="completed").length,P=s.length>0?Math.round(R/s.length*100):0,Y=a.filter(l=>{if(!l.createdAt)return!1;const c=l.createdAt.toDate();return c.getMonth()===v&&c.getFullYear()===A}).length;E({totalAppointments:s.length,appointmentsThisMonth:F,newPatientsThisMonth:Y,appointmentCompletionRate:P}),r("today")}catch(s){console.error("Error fetching dashboard data:",s),m("Failed to fetch dashboard data")}finally{u(!1)}})()},[j]);const r=t=>{D(t);const s=new Date().toISOString().split("T")[0];if(t==="today"){const a=p.filter(i=>i.date===s);y(a)}else if(t==="upcoming"){const a=p.filter(i=>i.date>s&&i.status!=="cancelled");y(a)}else t==="all"&&y(p)},N=async(t,s)=>{try{await I(t,{status:s}),h(a=>a.map(i=>i.id===t?{...i,status:s}:i)),r(d)}catch(a){console.error("Error updating appointment status:",a),m("Failed to update appointment status")}},S=async t=>{if(window.confirm("Are you sure you want to delete this appointment? This action cannot be undone."))try{await V(t),h(s=>s.filter(a=>a.id!==t)),r(d)}catch(s){console.error("Error deleting appointment:",s),m("Failed to delete appointment")}};return T?e.jsx(U,{}):j!=="admin"?e.jsx("div",{className:"pt-24 pb-16",children:e.jsx("div",{className:"container-custom py-8",children:e.jsx("div",{className:"bg-red-50 border-l-4 border-red-500 p-4 rounded-md",children:e.jsxs("div",{className:"flex",children:[e.jsx(k,{className:"h-6 w-6 text-red-500 mr-3"}),e.jsxs("div",{children:[e.jsx("h3",{className:"text-lg font-medium text-red-800",children:"Access Denied"}),e.jsx("p",{className:"text-red-700",children:"You do not have permission to access the admin dashboard."})]})]})})})}):e.jsxs("div",{className:"pt-24 pb-16",children:[e.jsx("div",{className:"bg-gray-800 text-white py-8",children:e.jsxs("div",{className:"container-custom",children:[e.jsx("h1",{className:"text-3xl font-bold mb-2",children:"Admin Dashboard"}),e.jsxs("p",{className:"text-gray-300",children:["Welcome back, ",(g==null?void 0:g.displayName)||"Admin"]})]})}),e.jsxs("div",{className:"container-custom py-8",children:[w&&e.jsx("div",{className:"bg-red-50 border-l-4 border-red-500 p-4 rounded-md mb-8",children:e.jsxs("div",{className:"flex",children:[e.jsx(k,{className:"h-6 w-6 text-red-500 mr-3"}),e.jsx("div",{children:e.jsx("p",{className:"text-red-700",children:w})})]})}),e.jsxs("div",{className:"grid grid-cols-1 md:grid-cols-4 gap-6 mb-8",children:[e.jsxs(o.div,{className:"bg-white rounded-lg shadow-md p-6",initial:{opacity:0,y:20},animate:{opacity:1,y:0},transition:{duration:.3},children:[e.jsxs("div",{className:"flex items-center justify-between mb-4",children:[e.jsx(C,{className:"h-8 w-8 text-sky-600"}),e.jsx("span",{className:"text-3xl font-bold",children:x.appointmentsThisMonth})]}),e.jsx("p",{className:"text-gray-600",children:"Appointments This Month"})]}),e.jsxs(o.div,{className:"bg-white rounded-lg shadow-md p-6",initial:{opacity:0,y:20},animate:{opacity:1,y:0},transition:{duration:.3,delay:.1},children:[e.jsxs("div",{className:"flex items-center justify-between mb-4",children:[e.jsx(q,{className:"h-8 w-8 text-green-600"}),e.jsx("span",{className:"text-3xl font-bold",children:x.newPatientsThisMonth})]}),e.jsx("p",{className:"text-gray-600",children:"New Patients This Month"})]}),e.jsxs(o.div,{className:"bg-white rounded-lg shadow-md p-6",initial:{opacity:0,y:20},animate:{opacity:1,y:0},transition:{duration:.3,delay:.2},children:[e.jsxs("div",{className:"flex items-center justify-between mb-4",children:[e.jsx(z,{className:"h-8 w-8 text-amber-600"}),e.jsx("span",{className:"text-3xl font-bold",children:x.totalAppointments})]}),e.jsx("p",{className:"text-gray-600",children:"Total Appointments"})]}),e.jsxs(o.div,{className:"bg-white rounded-lg shadow-md p-6",initial:{opacity:0,y:20},animate:{opacity:1,y:0},transition:{duration:.3,delay:.3},children:[e.jsxs("div",{className:"flex items-center justify-between mb-4",children:[e.jsx(O,{className:"h-8 w-8 text-indigo-600"}),e.jsxs("span",{className:"text-3xl font-bold",children:[x.appointmentCompletionRate,"%"]})]}),e.jsx("p",{className:"text-gray-600",children:"Completion Rate"})]})]}),e.jsxs(o.div,{className:"bg-white rounded-lg shadow-md overflow-hidden",initial:{opacity:0,y:20},animate:{opacity:1,y:0},transition:{duration:.5},children:[e.jsx("div",{className:"border-b border-gray-200",children:e.jsxs("div",{className:"flex",children:[e.jsx("button",{className:`px-6 py-3 font-medium ${d==="today"?"text-sky-600 border-b-2 border-sky-600":"text-gray-600 hover:text-gray-800"}`,onClick:()=>r("today"),children:"Today's Appointments"}),e.jsx("button",{className:`px-6 py-3 font-medium ${d==="upcoming"?"text-sky-600 border-b-2 border-sky-600":"text-gray-600 hover:text-gray-800"}`,onClick:()=>r("upcoming"),children:"Upcoming Appointments"}),e.jsx("button",{className:`px-6 py-3 font-medium ${d==="all"?"text-sky-600 border-b-2 border-sky-600":"text-gray-600 hover:text-gray-800"}`,onClick:()=>r("all"),children:"All Appointments"})]})}),e.jsx("div",{className:"p-6",children:b.length>0?e.jsx("div",{className:"overflow-x-auto",children:e.jsxs("table",{className:"min-w-full divide-y divide-gray-200",children:[e.jsx("thead",{className:"bg-gray-50",children:e.jsxs("tr",{children:[e.jsx("th",{className:"px-6 py-3 text-left text-xs font-medium text-gray-500 uppercase tracking-wider",children:"Patient"}),e.jsx("th",{className:"px-6 py-3 text-left text-xs font-medium text-gray-500 uppercase tracking-wider",children:"Date & Time"}),e.jsx("th",{className:"px-6 py-3 text-left text-xs font-medium text-gray-500 uppercase tracking-wider",children:"Service"}),e.jsx("th",{className:"px-6 py-3 text-left text-xs font-medium text-gray-500 uppercase tracking-wider",children:"Doctor"}),e.jsx("th",{className:"px-6 py-3 text-left text-xs font-medium text-gray-500 uppercase tracking-wider",children:"Status"}),e.jsx("th",{className:"px-6 py-3 text-left text-xs font-medium text-gray-500 uppercase tracking-wider",children:"Actions"})]})}),e.jsx("tbody",{className:"bg-white divide-y divide-gray-200",children:b.map(t=>e.jsxs("tr",{className:"hover:bg-gray-50",children:[e.jsxs("td",{className:"px-6 py-4 whitespace-nowrap",children:[e.jsx("div",{className:"font-medium text-gray-900",children:t.patientName}),e.jsx("div",{className:"text-gray-500 text-sm",children:t.patientEmail})]}),e.jsxs("td",{className:"px-6 py-4 whitespace-nowrap",children:[e.jsx("div",{className:"text-gray-900",children:t.date}),e.jsx("div",{className:"text-gray-500",children:t.time})]}),e.jsx("td",{className:"px-6 py-4 whitespace-nowrap",children:e.jsx("div",{className:"text-gray-900",children:t.service})}),e.jsx("td",{className:"px-6 py-4 whitespace-nowrap",children:e.jsx("div",{className:"text-gray-900",children:t.doctorName})}),e.jsx("td",{className:"px-6 py-4 whitespace-nowrap",children:t.status==="confirmed"?e.jsx("span",{className:"bg-green-100 text-green-800 text-xs px-2 py-1 rounded-full",children:"Confirmed"}):t.status==="pending"?e.jsx("span",{className:"bg-amber-100 text-amber-800 text-xs px-2 py-1 rounded-full",children:"Pending"}):t.status==="completed"?e.jsx("span",{className:"bg-blue-100 text-blue-800 text-xs px-2 py-1 rounded-full",children:"Completed"}):e.jsx("span",{className:"bg-red-100 text-red-800 text-xs px-2 py-1 rounded-full",children:"Cancelled"})}),e.jsx("td",{className:"px-6 py-4 whitespace-nowrap text-right text-sm font-medium",children:e.jsxs("div",{className:"flex space-x-2",children:[t.status==="pending"&&e.jsx("button",{onClick:()=>N(t.id,"confirmed"),className:"text-green-600 hover:text-green-900","aria-label":"Confirm appointment",title:"Confirm",children:e.jsx(M,{className:"h-5 w-5"})}),(t.status==="pending"||t.status==="confirmed")&&e.jsx("button",{onClick:()=>N(t.id,"completed"),className:"text-blue-600 hover:text-blue-900","aria-label":"Mark as completed",title:"Mark as completed",children:e.jsx(M,{className:"h-5 w-5"})}),e.jsx("button",{className:"text-sky-600 hover:text-sky-900","aria-label":"Edit appointment",title:"Edit",children:e.jsx(W,{className:"h-5 w-5"})}),e.jsx("button",{onClick:()=>N(t.id,"cancelled"),className:"text-amber-600 hover:text-amber-900","aria-label":"Cancel appointment",title:"Cancel",children:e.jsx(B,{className:"h-5 w-5"})}),e.jsx("button",{onClick:()=>S(t.id),className:"text-red-600 hover:text-red-900","aria-label":"Delete appointment",title:"Delete",children:e.jsx(X,{className:"h-5 w-5"})})]})})]},t.id))})]})}):e.jsxs("div",{className:"text-center py-8",children:[e.jsx(C,{className:"h-12 w-12 mx-auto text-gray-400 mb-3"}),e.jsx("h3",{className:"text-lg font-medium text-gray-700 mb-1",children:"No Appointments"}),e.jsx("p",{className:"text-gray-500",children:"There are no appointments scheduled for this period."})]})})]})]})]})};export{te as default};
